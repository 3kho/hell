(function(Z){function V(I,L,K,r,F,h){if(!(isNaN(h)||1>h)){h|=0;I=document.getElementById(I).getContext("2d");var A;try{try{A=I.getImageData(L,K,r,F)}catch(R){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),A=I.getImageData(L,K,r,F)}catch(T){throw alert("Cannot access local image"),Error("unable to access local image data: "+T);}}}catch(U){throw alert("Cannot access image"),Error("unable to access image data: "+U);}for(var a=A.data,G=4*A.width*A.height,l=0;l<G;l+=4){var c=
a[l+3]/255;a[l]*=c;a[l+1]*=c;a[l+2]*=c}var a=A.data,k,s,d,e,f,z,n,p,q,m,v,w,x,y,t,B,E,H,u,C,D,b,M;k=h+h+1;var N=r-1,G=F-1,l=h+1,c=l*(l+1)/2,J=new S,g=J;for(d=1;d<k;d++)if(g=g.next=new S,d==l)var O=g;g.next=J;g=d=null;z=f=0;var P=W[h],Q=X[h];for(s=0;s<F;s++){t=B=E=H=n=p=q=m=0;v=l*(u=a[f]);w=l*(C=a[f+1]);x=l*(D=a[f+2]);y=l*(b=a[f+3]);n+=c*u;p+=c*C;q+=c*D;m+=c*b;g=J;for(d=0;d<l;d++)g.r=u,g.g=C,g.b=D,g.a=b,g=g.next;for(d=1;d<l;d++)e=f+((N<d?N:d)<<2),n+=(g.r=u=a[e])*(M=l-d),p+=(g.g=C=a[e+1])*M,q+=(g.b=
D=a[e+2])*M,m+=(g.a=b=a[e+3])*M,t+=u,B+=C,E+=D,H+=b,g=g.next;d=J;g=O;for(k=0;k<r;k++)a[f]=n*P>>Q,a[f+1]=p*P>>Q,a[f+2]=q*P>>Q,a[f+3]=m*P>>Q,n-=v,p-=w,q-=x,m-=y,v-=d.r,w-=d.g,x-=d.b,y-=d.a,e=z+((e=k+h+1)<N?e:N)<<2,t+=d.r=a[e],B+=d.g=a[e+1],E+=d.b=a[e+2],H+=d.a=a[e+3],n+=t,p+=B,q+=E,m+=H,d=d.next,v+=u=g.r,w+=C=g.g,x+=D=g.b,y+=b=g.a,t-=u,B-=C,E-=D,H-=b,g=g.next,f+=4;z+=r}for(k=0;k<r;k++){B=E=H=t=p=q=m=n=0;f=k<<2;v=l*(u=a[f]);w=l*(C=a[f+1]);x=l*(D=a[f+2]);y=l*(b=a[f+3]);n+=c*u;p+=c*C;q+=c*D;m+=c*b;g=J;
for(d=0;d<l;d++)g.r=u,g.g=C,g.b=D,g.a=b,g=g.next;e=r;for(d=1;d<=h;d++)f=e+k<<2,n+=(g.r=u=a[f])*(M=l-d),p+=(g.g=C=a[f+1])*M,q+=(g.b=D=a[f+2])*M,m+=(g.a=b=a[f+3])*M,t+=u,B+=C,E+=D,H+=b,g=g.next,d<G&&(e+=r);f=k;d=J;g=O;for(s=0;s<F;s++)e=f<<2,a[e]=n*P>>Q,a[e+1]=p*P>>Q,a[e+2]=q*P>>Q,a[e+3]=m*P>>Q,n-=v,p-=w,q-=x,m-=y,v-=d.r,w-=d.g,x-=d.b,y-=d.a,e=k+((e=s+l)<G?e:G)*r<<2,n+=t+=d.r=a[e],p+=B+=d.g=a[e+1],q+=E+=d.b=a[e+2],m+=H+=d.a=a[e+3],d=d.next,v+=u=g.r,w+=C=g.g,x+=D=g.b,y+=b=g.a,t-=u,B-=C,E-=D,H-=b,g=g.next,
f+=r}r=A.data;F=4*A.width*A.height;for(h=0;h<F;h+=4)O=r[h+3],0!=O&&(O=255/O,r[h]*=O,r[h+1]*=O,r[h+2]*=O);I.putImageData(A,L,K)}}function Y(I,L,K,r,F,h){if(!(isNaN(h)||1>h)){h|=0;I=document.getElementById(I).getContext("2d");var A;try{try{A=I.getImageData(L,K,r,F)}catch(R){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),A=I.getImageData(L,K,r,F)}catch(T){throw alert("Cannot access local image"),Error("unable to access local image data: "+T);}}}catch(U){throw alert("Cannot access image"),
Error("unable to access image data: "+U);}var a=A.data,G,l,c,k,s,d,e,f,z,n,p,q,m,v,w,x,y,t,B;G=h+h+1;var E=r-1,H=F-1,u=h+1,C=u*(u+1)/2,D=new S,b=D;for(c=1;c<G;c++)if(b=b.next=new S,c==u)var M=b;b.next=D;b=c=null;d=s=0;var N=W[h],J=X[h];for(l=0;l<F;l++){m=v=w=e=f=z=0;n=u*(x=a[s]);p=u*(y=a[s+1]);q=u*(t=a[s+2]);e+=C*x;f+=C*y;z+=C*t;b=D;for(c=0;c<u;c++)b.r=x,b.g=y,b.b=t,b=b.next;for(c=1;c<u;c++)k=s+((E<c?E:c)<<2),e+=(b.r=x=a[k])*(B=u-c),f+=(b.g=y=a[k+1])*B,z+=(b.b=t=a[k+2])*B,m+=x,v+=y,w+=t,b=b.next;
c=D;b=M;for(G=0;G<r;G++)a[s]=e*N>>J,a[s+1]=f*N>>J,a[s+2]=z*N>>J,e-=n,f-=p,z-=q,n-=c.r,p-=c.g,q-=c.b,k=d+((k=G+h+1)<E?k:E)<<2,m+=c.r=a[k],v+=c.g=a[k+1],w+=c.b=a[k+2],e+=m,f+=v,z+=w,c=c.next,n+=x=b.r,p+=y=b.g,q+=t=b.b,m-=x,v-=y,w-=t,b=b.next,s+=4;d+=r}for(G=0;G<r;G++){v=w=m=f=z=e=0;s=G<<2;n=u*(x=a[s]);p=u*(y=a[s+1]);q=u*(t=a[s+2]);e+=C*x;f+=C*y;z+=C*t;b=D;for(c=0;c<u;c++)b.r=x,b.g=y,b.b=t,b=b.next;k=r;for(c=1;c<=h;c++)s=k+G<<2,e+=(b.r=x=a[s])*(B=u-c),f+=(b.g=y=a[s+1])*B,z+=(b.b=t=a[s+2])*B,m+=x,v+=
y,w+=t,b=b.next,c<H&&(k+=r);s=G;c=D;b=M;for(l=0;l<F;l++)k=s<<2,a[k]=e*N>>J,a[k+1]=f*N>>J,a[k+2]=z*N>>J,e-=n,f-=p,z-=q,n-=c.r,p-=c.g,q-=c.b,k=G+((k=l+u)<H?k:H)*r<<2,e+=m+=c.r=a[k],f+=v+=c.g=a[k+1],z+=w+=c.b=a[k+2],c=c.next,n+=x=b.r,p+=y=b.g,q+=t=b.b,m-=x,v-=y,w-=t,b=b.next,s+=r}I.putImageData(A,L,K)}}function S(){this.a=this.b=this.g=this.r=0;this.next=null}var W=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,
428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,
324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],X=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,
19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],R={image:function(I,L,K,r){I=document.getElementById(I);var F=I.naturalWidth,h=I.naturalHeight,A=document.getElementById(L);A.style.width=F+"px";A.style.height=h+"px";A.width=F;A.height=h;A=A.getContext("2d");A.clearRect(0,0,F,h);A.drawImage(I,0,0);isNaN(K)||1>K||(r?V(L,0,0,F,h,K):Y(L,0,0,F,h,K))},canvasRGBA:V,canvasRGB:Y};"undefined"!==typeof define&&define.amd?
define(function(){return R}):"undefined"!==typeof module&&module.exports&&(module.exports=R);Z.stackBlur=R})("undefined"!==typeof window?window:this);
